"use strict";!function(n){function t(i){if(e[i])return e[i].exports;var o=e[i]={i:i,l:!1,exports:{}};return n[i].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var e={};t.m=n,t.c=e,t.i=function(n){return n},t.d=function(n,e,i){t.o(n,e)||Object.defineProperty(n,e,{configurable:!1,enumerable:!0,get:i})},t.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(e,"a",e),e},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="/",t(t.s=3)}([function(n,t){!function(n){var t=function(t){return null!=t||t!=n},e=function(n,t){for(var e=o._callbacks[n],i=0;i<e.length;i++)e[i].apply(window,t)},i=function(n){for(var t=0,e=n.length-1;e>n.length-6;e--)t+=n[e];return t/5},o=window.Compass={method:n,watch:function(n){var t=++o._lastId;return o.init(function(e){if("phonegap"==e)o._watchers[t]=o._nav.compass.watchHeading(n);else if("webkitOrientation"==e){var i=function(t){n(t.webkitCompassHeading)};o._win.addEventListener("deviceorientation",i),o._watchers[t]=i}else if("orientationAndGPS"==e){var a,i=function(t){a=-t.alpha+o._gpsDiff,a<0?a+=360:a>360&&(a-=360),n(a)};o._win.addEventListener("deviceorientation",i),o._watchers[t]=i}}),t},unwatch:function(n){return o.init(function(t){"phonegap"==t?o._nav.compass.clearWatch(o._watchers[n]):("webkitOrientation"==t||"orientationAndGPS"==t)&&o._win.removeEventListener("deviceorientation",o._watchers[n]),delete o._watchers[n]}),o},needGPS:function(n){return o._callbacks.needGPS.push(n),o},needMove:function(n){return o._callbacks.needMove.push(n),o},noSupport:function(n){return!1===o.method?n():t(o.method)||o._callbacks.noSupport.push(n),o},init:function(n){return t(o.method)?void n(o.method):(o._callbacks.init.push(n),o._initing?void 0:(o._initing=!0,o._nav.compass?o._start("phonegap"):o._win.DeviceOrientationEvent?(o._checking=0,o._win.addEventListener("deviceorientation",o._checkEvent),setTimeout(function(){!1!==o._checking&&o._start(!1)},500)):o._start(!1),o))},_lastId:0,_watchers:{},_win:window,_nav:navigator,_callbacks:{init:[],noSupport:[],needGPS:[],needMove:[]},_initing:!1,_gpsDiff:n,_start:function(n){o.method=n,o._initing=!1,e("init",[n]),o._callbacks.init=[],!1===n&&e("noSupport",[]),o._callbacks.noSupport=[]},_checking:!1,_checkEvent:function(n){o._checking+=1;var e=!1;t(n.webkitCompassHeading)?o._start("webkitOrientation"):t(n.alpha)&&o._nav.geolocation?o._gpsHack():o._checking>1?o._start(!1):e=!0,e||(o._checking=!1,o._win.removeEventListener("deviceorientation",o._checkEvent))},_gpsHack:function(){var n=!0,a=[],c=[];e("needGPS");var r=function(n){a.push(n.alpha)};o._win.addEventListener("deviceorientation",r);var s=function(s){var u=s.coords;t(u.heading)&&(n&&(n=!1,e("needMove")),u.speed>1?(c.push(u.heading),c.length>=5&&a.length>=5&&(o._win.removeEventListener("deviceorientation",r),o._nav.geolocation.clearWatch(d),o._gpsDiff=i(c)+i(a),o._start("orientationAndGPS"))):c=[])},u=function(){o._win.removeEventListener("deviceorientation",r),o._start(!1)},d=o._nav.geolocation.watchPosition(s,u,{enableHighAccuracy:!0})}}}()},function(n,t){},function(n,t){},function(n,t,e){function i(n){if(p&&!(Math.floor(n)>=f-2&&Math.floor(n)<=f+2)){f=n;var t=s(n),e=Math.cos(t),i=Math.sin(t);d.setListenerOrientation(e,i,0,0,0,1)}}function o(n){p&&(a(),w=1/n)}function a(){if(p)for(var n=0;n<_.length;n++){var t=geolib.getBearing({latitude:v,longitude:h},{latitude:_[n].lat,longitude:_[n].long}),e=geolib.getDistance({latitude:v,longitude:h},{latitude:_[n].lat,longitude:_[n].long})*w,i=Math.cos(t)*e,o=Math.sin(t)*e;g[n].setPosition(i,o,0),console.log(i,o)}}function c(n){v=n.coords.latitude,h=n.coords.longitude,document.getElementById("lat").innerHTML=geolib.decimal2sexagesimal(v)+" N",document.getElementById("long").innerHTML=geolib.decimal2sexagesimal(h)+" E"}function r(){u=new(window.AudioContext||window.webkitAudioContext),d=new ResonanceAudio(u,{ambisonicOrder:1});for(var n=[],t=0;t<_.length;t++)l[t]=document.createElement("audio"),l[t].src=_[t].src,l[t].load(),l[t].loop=!0,l[t].crossOrigin="anonymous",n[t]=u.createMediaElementSource(l[t]),g[t]=d.createSource(),n[t].connect(g[t].input);d.output.connect(u.destination),p=!0}function s(n){return n*(Math.PI/180)}e(1),e(2),e(0);var u=void 0,d=void 0,l=[],g=[],f=0,v=31.77247675,h=35.21536082,_=[{lat:31.767436,long:35.215317,src:"./assets/song.wav"}],p=!1,m=!1,w=.02,E=function(){r();navigator.geolocation.watchPosition(c,function(n){alert("Cannot get location"),console.log(n)},{enableHighAccuracy:!0});document.getElementById("play").addEventListener("touchstart",function(n){n.target.classList.add("active")}),document.getElementById("play").addEventListener("touchend",function(n){n.target.classList.remove("active")}),document.getElementById("play").addEventListener("click",function(n){u.resume(),p&&(Compass.watch(function(n){document.getElementById("heading").innerHTML=Math.floor(n)+"Â°",i(n)}),m?(l.forEach(function(n){n.pause()}),m=!1,n.target.innerHTML="Play"):(a(),l.forEach(function(n){n.play()}),m=!0,n.target.innerHTML="Pause"))}),document.getElementById("dist").addEventListener("input",function(n){o(n.target.value)})};window.addEventListener("load",E)}]);